# import libraries
import random
import numpy as np
import pandas as pd
import datetime
from util import *

# Ignore warnings
import warnings
warnings.filterwarnings('ignore')

# Loading data -----------------------------------------------------------------
train_all = pd.read_csv(TRAIN_DATA_PATH,
                       usecols=[1, 2, 3, 4, 5],
                       dtype=LOAD_TYPES,
                       converters={'unit_sales': lambda u: np.log1p(float(u)) if float(u) > 0 else 0},
                       parse_dates=["date"],
                       # skiprows=range(1, 66458909)  # 2016-01-01 (59038132, 5)
                       skiprows=range(1, 101688780)  # 2017-01-01 (59038132, 5)
                       )
items_sampled = random.sample(list(train_all['item_nbr'].unique()), 30)
train_sampled = train[train['item_nbr'].isin(items_sampled)]
train_sampled.to_csv(TRAIN_DATA_PATH_SAMPLE_item30, index = False)
